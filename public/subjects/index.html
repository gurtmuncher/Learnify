<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Learnify - Subjects</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="/scram/scramjet.all.js"></script>
    <script src="/baremux/index.js"></script>
</head>
<body>
<canvas id="bg"></canvas>

<header>
    <div class="header-inner">
        <a href="/" class="logo">Learnify</a>
        <nav>
            <a href="/">Home</a>
            <a href="/subjects/index.html">Subjects</a>
            <a href="/settings/index.html">Settings</a>
            <a href="/about/index.html">About</a>
        </nav>
    </div>
</header>

<div class="container">
    <div class="page-header">
        <h1>Subjects</h1>
        <p>Choose a subject to explore</p>
    </div>

    <div class="subject-grid" id="subject-grid"></div>
</div>
<script>
    //these urls where generated by ai cause idek that many educational sites
    const subjects = [
        { name: "Math", icon: "M", url: "https://www.khanacademy.org/math" },
        { name: "Science", icon: "S", url: "https://www.khanacademy.org/science" },
        { name: "History", icon: "H", url: "https://www.khanacademy.org/humanities/world-history" },
        { name: "English", icon: "E", url: "https://www.khanacademy.org/humanities/grammar" },
        { name: "Geography", icon: "G", url: "https://www.nationalgeographic.com/geography" },
        { name: "Computer Science", icon: "CS", url: "https://www.khanacademy.org/computing" },
        { name: "Art", icon: "A", url: "https://www.khanacademy.org/humanities/art-history" },
        { name: "Music", icon: "M", url: "https://www.musictheory.net" },
        { name: "Study Hall", icon: "SH", url: "https://www.quizlet.com" },
        { name: "Independent Work", icon: "IW", url: "https://www.wolframalpha.com" },
        { name: "Extra Credit", icon: "EC", url: "https://www.coursera.org" },
        { name: "Law Study", icon: "L", url: "https://www.law.cornell.edu" },
        { name: "Spanish", icon: "SP", url: "https://www.duolingo.com" }
    ];

    let scramjet, connection;

    async function initProxy() {
        const loader = document.getElementById("proxy-loader");

        const { ScramjetController } = $scramjetLoadController();
        scramjet = new ScramjetController({
            files: {
                wasm: "/scram/scramjet.wasm.wasm",
                all: "/scram/scramjet.all.js",
                sync: "/scram/scramjet.sync.js"
            }
        });
        scramjet.init();

        connection = new BareMux.BareMuxConnection("/baremux/worker.js");

        if (navigator.serviceWorker) {
            await navigator.serviceWorker.register("/sw.js");
        }

        const wispUrl = (location.protocol === "https:" ? "wss" : "ws") + "://" + location.host + "/wisp/";
        const transport = await connection.getTransport();
        if (transport !== "/libcurl/index.mjs") {
            await connection.setTransport("/libcurl/index.mjs", [{ websocket: wispUrl }]);
        }

    }

    async function openSubject(url) {
        const frame = scramjet.createFrame();
        frame.frame.style.cssText = "position:fixed;top:0;left:0;width:100%;height:100%;border:none;z-index:9999;";
        document.body.appendChild(frame.frame);
        frame.go(url);
    }

    function renderSubjects() {
        const grid = document.getElementById("subject-grid");
        let html = "";

        for (const subject of subjects) {
            html += `
                <div class="subject-card" data-url="${subject.url}">
                    <div class="subject-icon">${subject.icon}</div>
                    <span>${subject.name}</span>
                </div>
            `;
        }

        grid.innerHTML = html;

        document.querySelectorAll(".subject-card").forEach(card => {
            card.addEventListener("click", () => {
                openSubject(card.dataset.url);
            });
        });
    }

    initProxy().then(() => {
        renderSubjects();
    });
</script>

<script src="/js/settings.js"></script>
<script src="/js/background.js"></script>
</body>
</html>